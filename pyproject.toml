[tool.poetry]
name = "cargpt"
version = "0.1.0"
description = ""
authors = ["Evgenii Gorchakov <evgenii@yaak.ai>"]
readme = "README.md"

[tool.poetry.dependencies]
python = ">=3.10,<3.11"
pytorch-lightning = "^1.9.0"
einops = "^0.6.0"
hydra-core = "^1.3.0"
loguru = "^0.6.0"
jaxtyping = "*"
beartype = "*"
torch = "^1.13.1"
torchvision = "^0.14.1"
more-itertools = "^9.0.0"
torchinfo = "^1.7.2"
deephouse = {git = "git@github.com:yaak-ai/deephouse.git", rev = "main"}

[build-system]
requires = ["poetry-core>=1.5.0"]
build-backend = "poetry.core.masonry.api"

[tool.poetry.group.train]
optional = true

[tool.poetry.group.train.dependencies]
wandb = "*"
omegaconf = "^2.3.0"
yaak-datasets = {git = "git@github.com:yaak-ai/yaak-datasets.git", tag = "v0.11.1"}

[tool.poetry.group.lint]
optional = true

[tool.poetry.group.lint.dependencies]
black = "*"
isort = "*"
mypy = "*"
mypy-extensions = "*"
ruff = "*"
deptry = "*"

[tool.poetry.group.dev]
optional = true

[tool.poetry.group.dev.dependencies]
ipdb = "*"
ipython = "*"
pudb = "*"
pyls-isort = "*"
pylsp-mypy = "*"
pylsp-rope = "*"
pytest-pudb = "*"
python-lsp-black = "*"
python-lsp-server = "*"
python-lsp-ruff = "*"
jupyterlab = "*"
jupyterlab-vim = "*"
torchshow = "*"
netron = "*"
ipython-autoimport = "*"
pyfzf = "*"

[tool.poetry.group.vis]
optional = true

[tool.poetry.group.vis.dependencies]
grad-cam = "*"

[tool.black]
line-length = 88

[tool.isort]
profile = "black"

[tool.mypy]
warn_unused_configs = true
ignore_missing_imports = true
check_untyped_defs = true
exclude = [
  "wandb/.*"
]

[tool.ruff]
line-length = 88
fix = true
ignore = ["E501", "F722", "F821"]

[tool.deptry]
ignore_obsolete = [
  "beartype",
]

ignore_transitive = [
  "omegaconf",
  "wandb",
  "numpy",
]

ignore_missing = [
  # deptry doesn't handle groups different than dev
  "cv2",
  "pytorch_grad_cam",
]
