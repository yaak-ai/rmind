#@ drives = [
#@    'Niro102-HQ/2022-11-25--11-53-38',
#@    'Niro102-HQ/2023-05-10--15-22-33',
#@    'Niro111-HQ/2023-05-02--12-47-16',
#@    'Niro101-HQ/2023-04-02--10-08-57',
#@    'Niro102-HQ/2022-11-30--13-36-15',
#@    'Niro111-HQ/2023-05-06--12-36-59',
#@    'Niro111-HQ/2023-04-22--10-01-32',
#@    'Niro102-HQ/2023-04-01--07-42-28',
#@    'Niro110-HQ/2023-03-14--15-08-22',
#@    'Niro108-HQ/2023-04-18--07-21-18',
#@    'Niro122-HQ/2023-03-27--10-46-50',
#@    'Niro122-HQ/2023-03-29--12-55-47',
#@    'Niro116-HQ/2023-04-26--06-37-03',
#@    'Niro102-HQ/2023-04-29--06-33-12',
#@    'Niro111-HQ/2023-03-16--10-55-01',
#@    'Niro104-HQ/2022-12-23--11-18-58',
#@    'Niro102-HQ/2023-05-17--10-41-47',
#@    'Niro121-HQ/2023-04-25--11-20-26',
#@    'Niro111-HQ/2023-04-26--12-05-10',
#@    'Niro106-HQ/2023-03-18--12-32-49',
#@    'Niro102-HQ/2023-05-11--13-05-01',
#@    'Niro112-HQ/2023-04-24--10-03-06',
#@    'Niro104-HQ/2023-05-08--05-53-39',
#@    'Niro102-HQ/2022-12-02--11-39-37',
#@    'Niro104-HQ/2023-01-02--08-57-26',
#@    'Niro102-HQ/2023-04-21--10-07-51',
#@    'Niro112-HQ/2023-05-05--10-28-34',
#@    'Niro108-HQ/2023-05-14--10-41-37',
#@    'Niro101-HQ/2023-04-15--06-37-57',
#@    'Niro102-HQ/2022-12-20--09-30-06',
#@    'Niro129-HQ/2023-04-13--11-35-26',
#@    'Niro132-HQ/2023-05-05--13-22-10',
#@    'Niro129-HQ/2023-04-13--11-45-36',
#@    'Niro102-HQ/2022-12-06--11-44-12',
#@    'Niro111-HQ/2023-03-14--13-48-56',
#@    'Niro102-HQ/2023-05-04--13-27-51',
#@    'Niro111-HQ/2023-05-07--10-57-09',
#@    'Niro104-HQ/2022-12-27--11-08-08',
#@    'Niro116-HQ/2023-04-26--06-37-41',
#@    'Niro111-HQ/2023-05-03--11-47-28',
#@    'Niro124-HQ/2023-03-24--10-53-40',
#@    'Niro127-HQ/2023-05-06--06-27-24',
#@    'Niro104-HQ/2023-04-01--11-31-55',
#@    'Niro096-HQ/2023-01-11--13-47-36',
#@    'Niro116-HQ/2023-04-25--07-50-19',
#@    'Niro127-HQ/2023-05-05--05-19-47',
#@    'Niro111-HQ/2023-03-28--10-09-18',
#@    'Niro104-HQ/2023-04-04--11-21-33',
#@    'Niro102-HQ/2023-03-17--10-35-24',
#@    'Niro104-HQ/2023-05-06--13-47-48',
#@    'Niro101-HQ/2023-05-17--05-14-41',
#@    'Niro131-HQ/2023-05-12--10-28-05',
#@    'Niro101-HQ/2023-05-05--16-24-38',
#@    'Niro111-HQ/2023-03-27--10-41-06',
#@    'Niro104-HQ/2023-04-10--16-43-17',
#@    'Niro111-HQ/2023-03-21--11-10-37',
#@    'Niro115-HQ/2023-05-13--13-57-38',
#@    'Niro112-HQ/2023-03-15--14-15-19',
#@    'Niro104-HQ/2023-05-04--07-35-19',
#@    'Niro121-HQ/2023-04-24--09-31-57',
#@    'Niro102-HQ/2022-11-29--09-31-54',
#@    'Niro104-HQ/2022-12-31--09-45-39',
#@    'Niro102-HQ/2022-12-10--13-34-05',
#@    'Niro102-HQ/2023-05-03--06-40-23',
#@    'Niro102-HQ/2023-01-13--11-34-35',
#@    'Niro102-HQ/2023-04-20--09-14-13',
#@    'Niro104-HQ/2022-12-25--10-23-53',
#@    'Niro101-HQ/2023-04-06--14-43-08',
#@    'Niro116-HQ/2023-04-26--12-12-54',
#@    'Niro106-HQ/2023-05-11--11-26-14',
#@    'Niro101-HQ/2023-05-04--05-36-51',
#@    'Niro106-HQ/2023-05-11--10-46-03',
#@    'Niro104-HQ/2022-12-30--13-44-00',
#@    'Niro102-HQ/2022-12-05--12-08-39',
#@    'Niro104-HQ/2022-12-24--11-52-25',
#@    'Niro107-HQ/2023-05-11--12-08-09',
#@    'Niro121-HQ/2023-05-02--06-30-16',
#@    'Niro101-HQ/2023-05-11--05-39-54',
#@    'Niro102-HQ/2023-05-13--06-37-10',
#@    'Niro131-HQ/2023-05-16--08-03-03',
#@    'Niro121-HQ/2023-05-02--16-11-43',
#@    'Niro103-HQ/2023-03-29--14-34-38',
#@    'Niro108-HQ/2023-04-18--07-47-30',
#@    'Niro102-HQ/2023-05-04--08-48-38',
#@    'Niro111-HQ/2023-05-11--09-53-29',
#@    'Niro111-HQ/2023-05-17--09-17-33',
#@    'Niro104-HQ/2022-12-17--09-51-15',
#@    'Niro107-HQ/2023-01-19--14-12-55',
#@    'Niro108-HQ/2023-05-14--15-28-33',
#@    'Niro110-HQ/2023-03-27--10-31-22',
#@    'Niro104-HQ/2023-04-27--09-05-58',
#@    'Niro104-HQ/2023-03-18--14-01-55',
#@    'Niro130-HQ/2023-05-17--15-26-52',
#@    'Niro104-HQ/2023-05-16--05-46-30',
#@    'Niro111-HQ/2023-04-13--11-47-04',
#@    'Niro121-HQ/2023-05-02--09-50-39',
#@    'Niro115-HQ/2023-05-13--13-18-18',
#@    'Niro112-HQ/2023-05-05--08-55-43',
#@    'Niro111-HQ/2023-04-26--07-01-08',
#@    'Niro115-HQ/2023-03-27--14-54-27',
#@    'Niro102-HQ/2023-03-29--14-00-10',
#@    'Niro102-HQ/2023-01-21--10-02-00',
#@    'Niro102-HQ/2023-03-25--10-04-49',
#@    'Niro104-HQ/2023-04-09--15-42-15',
#@    'Niro102-HQ/2023-05-10--14-02-20',
#@    'Niro121-HQ/2023-04-22--08-48-41',
#@    'Niro111-HQ/2023-04-16--13-12-12',
#@    'Niro102-HQ/2022-11-24--09-09-39',
#@    'Niro102-HQ/2023-05-17--14-13-50',
#@    'Niro116-HQ/2023-04-25--09-01-38',
#@    'Niro127-HQ/2023-04-27--11-33-40',
#@    'Niro104-HQ/2022-12-28--14-40-53',
#@    'Niro101-HQ/2023-05-09--14-03-54',
#@    'Niro111-HQ/2023-04-18--14-55-51',
#@    'Niro101-HQ/2023-04-02--13-27-47',
#@    'Niro104-HQ/2023-03-29--10-21-25',
#@    'Niro104-HQ/2023-04-22--13-13-47',
#@    'Niro132-HQ/2023-05-06--12-23-31',
#@    'Niro116-HQ/2023-04-25--09-24-03',
#@    'Niro101-HQ/2023-01-01--12-01-47',
#@    'Niro102-HQ/2023-04-21--16-20-28',
#@    'Niro102-HQ/2023-05-08--13-59-22',
#@    'Niro116-HQ/2023-04-26--14-38-26',
#@    'Niro115-HQ/2023-05-13--07-05-58',
#@    'Niro102-HQ/2023-05-02--07-05-06',
#@    'Niro104-HQ/2023-04-06--08-38-02',
#@    'Niro122-HQ/2023-03-31--13-38-13',
#@    'Niro111-HQ/2023-05-14--06-02-12',
#@    'Niro122-HQ/2023-04-17--10-35-13',
#@    'Niro111-HQ/2023-03-18--12-58-22',
#@ ]
#@ cameras = ['cam_front_left']
#@

_target_: yaak_datasets.Dataset
_recursive_: false
config:
  version: 0.12.1
  data:
    drives:
      #@ for drive in drives:
      - id: #@ drive
        sources:
          #@ for camera in cameras:
          - camera: #@ camera
            reader:
              _target_: yaak_datasets.FrameImageVideoReader
              path: ${paths.data_dir}/${....id}/frames/${..camera}.defish.mp4/576x324
              filename_format: '{:09d}.jpg'
          #@ end
        metadata:
          path: ${paths.data_dir}/${..id}/metadata.log
      #@ end

    metadata:
      cameras: #@ cameras
      select:
        - message: ImageMetadata
          fields:
          - name: frame_idx
          - name: camera_name

        - message: VehicleMotion
          fields:
          - name: speed
          - name: steering_angle_normalized
          - name: gas_pedal_normalized
          - name: brake_pedal_normalized

        - message: VehicleState
          fields:
          - name: turn_signal

        - message: Gnss
          fields:
          - name: hp_loc_latitude
          - name: hp_loc_longitude

  samples:
    alignment:
      ref_camera: #@ cameras[0]
      tolerance: 10ms

    clips:
      length: 1
      step: 1
      stride: 1

    transforms:

      - _target_: yaak_datasets.transforms.Crop
        offsets: [2, 2, 0, 0]

      - _target_: yaak_datasets.transforms.Normalize
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]

  processing:
    max_workers: null
    metadata:
      cache:
        enabled: true
        path: ${paths.metadata_cache_dir}
        size_limit: 1 GiB