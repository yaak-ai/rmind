model:
  _target_: cargpt.models.gato.TorchGPT2
  _recursive_: False
  transformer:
    _target_: torch.nn.TransformerEncoder
    num_layers: 8
    encoder_layer:
      _target_: cargpt.models.gato.TransformerEncoderLayerGEGLU
      d_model: ${embedding_dim}
      dim_feedforward: 512
      nhead: 4
      dropout: 0.1
      batch_first: True
      norm_first: True
  classifier:
    _target_: torch.nn.Linear
    in_features: ${embedding_dim}
    out_features: ${num_tokens_total}
  loss:
    _target_: torch.nn.CrossEntropyLoss
    ignore_index: -100
    reduction: mean