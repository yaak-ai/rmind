# @package _global_

defaults:
  - /paths: default
  - /vars: control_transformer/default
  - /model: control_transformer/embeddings
  - /datamodule: predict
  - _self_

output_dir: ???

trainer:
  _target_: pytorch_lightning.Trainer
  accelerator: gpu
  devices: 1
  benchmark: true
  logger: false
  callbacks:
    - _target_: cargpt.callbacks.TensorDictPredictionWriter
      write_interval: batch
      path: ${hydra:run.dir}/predictions/{batch_idx:06}/
      writer:
        _target_: tensordict.memmap
        _partial_: true
        copy_existing: true

    - _target_: cargpt.callbacks.ModelSummary
      depth: 5
datamodule:
  predict:
    shuffle: true
